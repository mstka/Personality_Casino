# Personality Casino


このリポジトリはオンラインカジノサービスの簡易プロトタイプです。
バックエンドは **FastAPI**、フロントエンドはシンプルな HTML ページで構成されています。

ユーザー登録とログイン機能を備え、各ユーザーに 1000 コインが付与されます。

ユーザー名・パスワード・コイン残高はバックエンドディレクトリに作成される
SQLite データベース `users.db` に保存されます。
各エンドポイントでは毎回 `sqlite3.connect()` を `with` 文で呼び出し、
接続とクローズを自動化しています。

ルーレットゲームではログイン後にコインをベットし、一定時間毎に自動で回る共通テーブルで結果が決まります。次のスピンまでの残り時間はフロントエンドで確認でき、締切直前には賭け場所をクリックできなくなります。結果が出るとアニメーションと共に残高が更新されます。フロントエンドではキャンバス上に描かれたホイールが回転し、当たった数字のマスがハイライトされます。
ホーム画面からゲーム画面やユーザー画面へ移動できます。
現状ゲームはルーレットのみですが、今後他のゲームを追加することを想定しています。

## 必要なもの

- Python 3.8 以上
- `fastapi` と `uvicorn` パッケージ
- パスワードハッシュ化に `passlib[bcrypt]`

インストールは以下のコマンドを実行してください。

```bash
pip install fastapi uvicorn passlib[bcrypt]
```

## サービスの起動方法

リポジトリのルートから次のコマンドで API サーバーを起動します。

```bash
uvicorn backend.main:app --reload
```

その後ブラウザで `frontend/index.html` を開いてください。ファイルを直接開く場合 (`file://` スキーム) は各 HTML の `API_BASE` 定数をバックエンドの URL (`http://localhost:8000` など) に合わせます。`python -m http.server` などでフロントエンドを HTTP 配信すると同一オリジンとなり、設定変更なしで動作します。


## ルーレットの簡易ルール

- 0 から 36 までの数字があるヨーロピアンスタイル。
- **数字**、**色**（赤・黒・緑）、**奇偶**（even/odd）のほか、
  1st/2nd/3rd 12、Low/High、複数数字への賭けも可能です。
- 数字は `35:1`、複数数字は選択数に応じた倍率、色・奇偶・Low/High は `1:1`、
  Dozen (12 数字) は `2:1` の払い戻しです。
- 金額を入力してから数字や各種オプションをクリックすると即座にベットが確定します。

このサンプルは実際の金銭やアカウント管理を行わないデモ目的のコードです。
